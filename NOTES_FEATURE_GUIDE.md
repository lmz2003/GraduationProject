# 笔记管理功能使用指南

## 功能概述

根据 PRD 文档要求，已实现完整的笔记管理功能，包括笔记的查看、新建、编辑、删除、搜索、筛选和排序。

## 主要功能

### 1. 笔记汇总页面（所有笔记）

**入口**: 点击侧边栏「我的笔记」→ 进入笔记汇总页面

**功能**:
- ✅ 查看所有笔记列表（分页展示）
- ✅ 搜索笔记（按标题关键字）
- ✅ 筛选笔记（按状态：草稿/已发布）
- ✅ 排序笔记（按更新时间/创建时间/标题，升序/降序）
- ✅ 新建笔记
- ✅ 删除笔记（带二次确认）

**列表展示信息**:
- 笔记标题
- 内容摘要
- 标签
- 状态（草稿/已发布）
- 最后修改时间

### 2. 笔记详情/编辑页面

**入口**:
- 从笔记列表点击任意笔记卡片
- 点击「新建笔记」按钮

**功能**:
- ✅ 编辑笔记标题
- ✅ 编辑笔记内容（Markdown 编辑器）
- ✅ 添加/删除标签
- ✅ 切换状态（草稿/已发布）
- ✅ 保存笔记
- ✅ 删除笔记
- ✅ 返回列表
- ✅ 未保存提示

## 技术实现

### 后端 API（已实现）

#### 1. 获取笔记列表
```
GET /api/notes

Query 参数:
- page: 页码（默认 1）
- pageSize: 每页数量（默认 20）
- keyword: 搜索关键字（标题）
- status: 状态筛选（draft/published）
- tag: 标签筛选
- sortBy: 排序字段（updatedAt/createdAt/title，默认 updatedAt）
- order: 排序方式（asc/desc，默认 desc）

响应格式:
{
  "code": 0,
  "message": "ok",
  "data": {
    "list": [...],
    "pagination": {
      "page": 1,
      "pageSize": 20,
      "total": 35
    }
  }
}
```

#### 2. 获取笔记详情
```
GET /api/notes/:id
```

#### 3. 新建笔记
```
POST /api/notes

Body:
{
  "title": "标题（可选）",
  "content": "内容",
  "tags": ["标签1", "标签2"],
  "status": "draft"
}
```

#### 4. 更新笔记
```
PUT /api/notes/:id

Body: 同新建笔记
```

#### 5. 删除笔记
```
DELETE /api/notes/:id
```

#### 6. 批量删除笔记
```
DELETE /api/notes

Body:
{
  "ids": ["id1", "id2", "id3"]
}
```

### 前端组件

#### 1. NotesListPage
- 路径: `/dashboard/notes`
- 文件: `frontend/src/Note/NotesListPage.tsx`
- 功能: 笔记列表展示、搜索、筛选、排序、分页

#### 2. NoteDetailPage
- 路径: `/dashboard/notes/:id` 或 `/dashboard/notes/new`
- 文件: `frontend/src/Note/NoteDetailPage.tsx`
- 功能: 笔记详情查看和编辑

### 数据模型

#### 笔记实体（Note）
```typescript
{
  id: string;           // 笔记ID
  title: string;        // 标题
  content: string;      // 内容
  summary: string;      // 摘要（自动生成）
  tags: string[];       // 标签数组
  status: string;       // 状态（draft/published）
  deleted: boolean;     // 逻辑删除标记
  createdAt: Date;      // 创建时间
  updatedAt: Date;      // 更新时间
  owner: User;          // 所属用户
}
```

## 使用流程

### 新建笔记
1. 进入笔记汇总页面
2. 点击「新建笔记」按钮
3. 编辑标题、内容、添加标签
4. 选择状态（草稿/已发布）
5. 点击「保存」

### 编辑笔记
1. 在笔记列表中点击要编辑的笔记
2. 在详情页修改内容
3. 点击「保存」

### 删除笔记
1. 在笔记列表中点击笔记卡片右上角的「删除」按钮
2. 确认删除操作
3. 或在详情页点击「删除」按钮

### 搜索笔记
1. 在笔记汇总页面顶部搜索框输入关键字
2. 系统自动搜索标题匹配的笔记

### 筛选和排序
1. 使用筛选条件下拉框选择状态
2. 使用排序下拉框选择排序字段和顺序
3. 系统自动更新列表

## 数据安全

- ✅ 所有接口都需要 JWT 认证
- ✅ 用户只能访问和操作自己的笔记
- ✅ 后端进行权限校验
- ✅ 采用逻辑删除，数据可恢复

## 交互特性

- ✅ 删除操作需要二次确认
- ✅ 未保存修改时离开页面会提示
- ✅ 标题为空时自动填充"未命名笔记"
- ✅ 摘要自动生成（取内容前 100 字符）
- ✅ 实时显示保存状态
- ✅ 友好的空状态提示

## 后续优化建议

1. **批量操作**: 支持批量删除、批量修改状态
2. **标签管理**: 标签自动补全、标签云展示
3. **富文本编辑**: 支持图片、代码高亮等
4. **版本历史**: 查看和恢复历史版本（已有后端支持）
5. **分享功能**: 支持笔记分享链接
6. **导出功能**: 导出为 PDF、Markdown
7. **全文搜索**: 支持内容搜索，而不仅是标题
8. **拖拽排序**: 支持自定义笔记顺序
9. **收藏功能**: 标记常用笔记
10. **分类管理**: 支持笔记本分类

## 已知问题

- Linter 警告: Select 元素缺少 accessible name (可通过添加 aria-label 解决)
- 标签筛选使用 LIKE 查询，在大数据量时性能可能不佳

## 测试建议

1. 测试新建笔记（带标题/不带标题）
2. 测试编辑笔记（修改标题/内容/标签/状态）
3. 测试删除笔记（单条删除）
4. 测试搜索功能（不同关键字）
5. 测试筛选功能（草稿/已发布）
6. 测试排序功能（不同字段和顺序）
7. 测试分页功能（翻页）
8. 测试权限（登出后访问）
9. 测试未保存提示（修改后直接返回）
10. 测试空状态展示
